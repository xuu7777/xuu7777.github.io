## OWASP Top10


OWASP Top 10 – 2013 （旧版） | OWASP Top 10 – 2017 （新版）
-|-
A1 －注入 | A1 －注入
A2 －失效的身份认证和会话管理 | A2 －失效的身份认证和会话管理
A3 －跨站脚本（XSS） | A3 －跨站脚本（XSS）
A4 －不安全的直接对象引用－与A7合并 | A4 －失效的访问控制（最初归类在2003/2004版）
A5 －安全配置错误 | A5 －安全配置错误
A6 －敏感信息泄漏 | A6 －敏感信息泄漏
A7 －功能级访问控制缺失－与A4合并 | A7 －攻击检测与防护不足(新增)
A8 －跨站请求伪造（CSRF） | A8 －跨站请求伪造（CSRF）
A9 -使用含有已知漏洞的组件 | A9 －使用含有已知漏洞的组件
A10 －未验证的重定向和转发 | A10 －未受有效保护的API (新增)


## A2 －失效的身份认证和会话管理
* 身份认证：身份认证最常用于登录系统，形式一般为用户名和密码的登录方式，在安全性要求较高的情况下，还有验证码、客户证书、Ukey等

* 原理：开发者通常会建立自定义的认证和会话管理方案。但与身份认证和会话管理相关的应用程序功能往往得不到正确的实现，要正确实现这些方案却很难，结果在退出、密码管理、超时、密码找回、账户更新等方面存在漏洞，这就导致了攻击者破坏密码、秘钥、会话令牌或攻击其他的漏洞去冒充其他用的身份（暂时或永久的）

* 检测失效的身份认证和会话管理：用户身份验证凭证没有使用哈希或密码保护，认证凭证可猜测，或者能够通过薄弱的账户管理功能（例如账户创建、密码修改、密码回复、弱会话ID）重写，会话ID暴露在URL里（例如URL重写），会话ID容易受到会话固定（session fixation）的攻击，会话ID没有超时限制，或者用户会话或身份验证令牌特别是单点登录令牌在用户注销时没有失效，成功注册后，会话ID没有轮转，密码、会话ID和其他认证凭据使用未加密连接传输。


![avatar](/src/static/img/rkl1.png)


* 例子：


1. 网秦某站弱口令导致的一次内网漫游：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2016-0219717
2. 中国民航某公司session泄露/任意用户登陆/红头文件：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2015-0162346
3. jcms系统7处session重置导致getshell：http://192.168.213.135:5000/static/bugs/wooyun-2016-0179791.html
4. 酷狗伪造session登陆：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2012-05486


### 防范
* 分区公共区域和受限区域：站点的公共区域允许任何人用户进行匿名访问，受限区域只能接受特定的用户访问。


1. 对cookie内容进行加密。
2. 可以设置锁定账户策略。
3. 设置密码和绘画的有效期，并使用强密码(密码必须是数字和字母的组合)。
4. 账号密码以密文形式传输。
5. 增强口令复杂度。


## A6 －敏感信息泄漏

### 敏感数据泄露常见漏洞点：
#### 用户信息泄露


##### 评论处：
* 乌云授权查看链接泄露那些事儿（不要到处乱发状态跟踪页面）：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2015-0104766


##### 转账处：
* 苏宁易购易付宝转账存在敏感信息泄露：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2015-0124969


##### 搜索处：
* 某大学邮箱所有用户信息泄露信息被搜索引擎收录：http://192.168.213.135:5000/static/bugs/wooyun-2014-069909.html


##### 越权：
* 暴风某站平行越权：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2016-0207583


##### 接口处：
* 苏宁某系统测试环境泄漏大量用户敏感信息：http://192.168.213.134/bug_detail.php?wybug_id=wooyun-2015-0116563